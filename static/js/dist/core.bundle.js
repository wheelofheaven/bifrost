(()=>{var sn=(r,s)=>()=>(s||r((s={exports:{}}).exports,s),s.exports);var kn=sn((it,Ee)=>{var Ze,We;Ze=it,We=function(){"use strict";function r(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),t.push.apply(t,i)}return t}function s(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?r(Object(t),!0).forEach(function(i){L(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function o(n){return o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(n)}function a(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function d(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function u(n,e,t){return e&&d(n.prototype,e),t&&d(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function L(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function I(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(n,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),writable:!1}),e&&C(n,e)}function x(n){return x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},x(n)}function C(n,e){return C=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t},C(n,e)}function Y(n,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(n)}function F(n){var e=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var t,i=x(n);if(e){var c=x(this).constructor;t=Reflect.construct(i,arguments,c)}else t=i.apply(this,arguments);return Y(this,t)}}function j(n){return function(e){if(Array.isArray(e))return J(e)}(n)||function(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}(n)||function(e,t){if(e){if(typeof e=="string")return J(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set"?Array.from(e):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?J(e,t):void 0}}(n)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function J(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function U(n){return Array.isArray?Array.isArray(n):D(n)==="[object Array]"}function W(n){return typeof n=="string"}function se(n){return typeof n=="number"}function Q(n){return n===!0||n===!1||function(e){return K(e)&&e!==null}(n)&&D(n)=="[object Boolean]"}function K(n){return o(n)==="object"}function y(n){return n!=null}function $(n){return!n.trim().length}function D(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(n)}var q=function(n){return"Invalid value for key ".concat(n)},le=function(n){return"Pattern length exceeds max of ".concat(n,".")},ne=Object.prototype.hasOwnProperty,g=function(){function n(e){var t=this;a(this,n),this._keys=[],this._keyMap={};var i=0;e.forEach(function(c){var l=w(c);i+=l.weight,t._keys.push(l),t._keyMap[l.id]=l,i+=l.weight}),this._keys.forEach(function(c){c.weight/=i})}return u(n,[{key:"get",value:function(e){return this._keyMap[e]}},{key:"keys",value:function(){return this._keys}},{key:"toJSON",value:function(){return JSON.stringify(this._keys)}}]),n}();function w(n){var e=null,t=null,i=null,c=1,l=null;if(W(n)||U(n))i=n,e=B(n),t=O(n);else{if(!ne.call(n,"name"))throw new Error(function(f){return"Missing ".concat(f," property in key")}("name"));var h=n.name;if(i=h,ne.call(n,"weight")&&(c=n.weight)<=0)throw new Error(function(f){return"Property 'weight' in key '".concat(f,"' must be a positive integer")}(h));e=B(h),t=O(h),l=n.getFn}return{path:e,id:t,weight:c,src:i,getFn:l}}function B(n){return U(n)?n:n.split(".")}function O(n){return U(n)?n.join("."):n}var P={useExtendedSearch:!1,getFn:function(n,e){var t=[],i=!1;return function c(l,h,f){if(y(l))if(h[f]){var v=l[h[f]];if(!y(v))return;if(f===h.length-1&&(W(v)||se(v)||Q(v)))t.push(function(_){return _==null?"":function(S){if(typeof S=="string")return S;var E=S+"";return E=="0"&&1/S==-1/0?"-0":E}(_)}(v));else if(U(v)){i=!0;for(var m=0,b=v.length;m<b;m+=1)c(v[m],h,f+1)}else h.length&&c(v,h,f+1)}else t.push(l)}(n,W(e)?e.split("."):e,0),i?t:t[0]},ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1},p=s(s(s(s({},{isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:function(n,e){return n.score===e.score?n.idx<e.idx?-1:1:n.score<e.score?-1:1}}),{includeMatches:!1,findAllMatches:!1,minMatchCharLength:1}),{location:0,threshold:.6,distance:100}),P),Ae=/[^ ]+/g;function k(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3,t=new Map,i=Math.pow(10,e);return{get:function(c){var l=c.match(Ae).length;if(t.has(l))return t.get(l);var h=1/Math.pow(l,.5*n),f=parseFloat(Math.round(h*i)/i);return t.set(l,f),f},clear:function(){t.clear()}}}var M=function(){function n(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.getFn,i=t===void 0?p.getFn:t,c=e.fieldNormWeight,l=c===void 0?p.fieldNormWeight:c;a(this,n),this.norm=k(l,3),this.getFn=i,this.isCreated=!1,this.setIndexRecords()}return u(n,[{key:"setSources",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.docs=e}},{key:"setIndexRecords",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.records=e}},{key:"setKeys",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.keys=t,this._keysMap={},t.forEach(function(i,c){e._keysMap[i.id]=c})}},{key:"create",value:function(){var e=this;!this.isCreated&&this.docs.length&&(this.isCreated=!0,W(this.docs[0])?this.docs.forEach(function(t,i){e._addString(t,i)}):this.docs.forEach(function(t,i){e._addObject(t,i)}),this.norm.clear())}},{key:"add",value:function(e){var t=this.size();W(e)?this._addString(e,t):this._addObject(e,t)}},{key:"removeAt",value:function(e){this.records.splice(e,1);for(var t=e,i=this.size();t<i;t+=1)this.records[t].i-=1}},{key:"getValueForItemAtKeyId",value:function(e,t){return e[this._keysMap[t]]}},{key:"size",value:function(){return this.records.length}},{key:"_addString",value:function(e,t){if(y(e)&&!$(e)){var i={v:e,i:t,n:this.norm.get(e)};this.records.push(i)}}},{key:"_addObject",value:function(e,t){var i=this,c={i:t,$:{}};this.keys.forEach(function(l,h){var f=l.getFn?l.getFn(e):i.getFn(e,l.path);if(y(f)){if(U(f))(function(){for(var m=[],b=[{nestedArrIndex:-1,value:f}];b.length;){var _=b.pop(),S=_.nestedArrIndex,E=_.value;if(y(E))if(W(E)&&!$(E)){var A={v:E,i:S,n:i.norm.get(E)};m.push(A)}else U(E)&&E.forEach(function(R,T){b.push({nestedArrIndex:T,value:R})})}c.$[h]=m})();else if(W(f)&&!$(f)){var v={v:f,n:i.norm.get(f)};c.$[h]=v}}}),this.records.push(c)}},{key:"toJSON",value:function(){return{keys:this.keys,records:this.records}}}]),n}();function z(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=t.getFn,c=i===void 0?p.getFn:i,l=t.fieldNormWeight,h=l===void 0?p.fieldNormWeight:l,f=new M({getFn:c,fieldNormWeight:h});return f.setKeys(n.map(w)),f.setSources(e),f.create(),f}function V(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.errors,i=t===void 0?0:t,c=e.currentLocation,l=c===void 0?0:c,h=e.expectedLocation,f=h===void 0?0:h,v=e.distance,m=v===void 0?p.distance:v,b=e.ignoreLocation,_=b===void 0?p.ignoreLocation:b,S=i/n.length;if(_)return S;var E=Math.abs(f-l);return m?S+E/m:E?1:S}function ae(){for(var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:p.minMatchCharLength,t=[],i=-1,c=-1,l=0,h=n.length;l<h;l+=1){var f=n[l];f&&i===-1?i=l:f||i===-1||((c=l-1)-i+1>=e&&t.push([i,c]),i=-1)}return n[l-1]&&l-i>=e&&t.push([i,l-1]),t}var fe=32;function Rt(n){for(var e={},t=0,i=n.length;t<i;t+=1){var c=n.charAt(t);e[c]=(e[c]||0)|1<<i-t-1}return e}var st=function(){function n(e){var t=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=i.location,l=c===void 0?p.location:c,h=i.threshold,f=h===void 0?p.threshold:h,v=i.distance,m=v===void 0?p.distance:v,b=i.includeMatches,_=b===void 0?p.includeMatches:b,S=i.findAllMatches,E=S===void 0?p.findAllMatches:S,A=i.minMatchCharLength,R=A===void 0?p.minMatchCharLength:A,T=i.isCaseSensitive,N=T===void 0?p.isCaseSensitive:T,H=i.ignoreLocation,G=H===void 0?p.ignoreLocation:H;if(a(this,n),this.options={location:l,threshold:f,distance:m,includeMatches:_,findAllMatches:E,minMatchCharLength:R,isCaseSensitive:N,ignoreLocation:G},this.pattern=N?e:e.toLowerCase(),this.chunks=[],this.pattern.length){var Z=function(re,Ye){t.chunks.push({pattern:re,alphabet:Rt(re),startIndex:Ye})},X=this.pattern.length;if(X>fe){for(var ie=0,pe=X%fe,Oe=X-pe;ie<Oe;)Z(this.pattern.substr(ie,fe),ie),ie+=fe;if(pe){var me=X-fe;Z(this.pattern.substr(me),me)}}else Z(this.pattern,0)}}return u(n,[{key:"searchIn",value:function(e){var t=this.options,i=t.isCaseSensitive,c=t.includeMatches;if(i||(e=e.toLowerCase()),this.pattern===e){var l={isMatch:!0,score:0};return c&&(l.indices=[[0,e.length-1]]),l}var h=this.options,f=h.location,v=h.distance,m=h.threshold,b=h.findAllMatches,_=h.minMatchCharLength,S=h.ignoreLocation,E=[],A=0,R=!1;this.chunks.forEach(function(N){var H=N.pattern,G=N.alphabet,Z=N.startIndex,X=function(me,re,Ye){var ve=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},ft=ve.location,en=ft===void 0?p.location:ft,vt=ve.distance,Te=vt===void 0?p.distance:vt,gt=ve.threshold,tn=gt===void 0?p.threshold:gt,pt=ve.findAllMatches,nn=pt===void 0?p.findAllMatches:pt,mt=ve.minMatchCharLength,yt=mt===void 0?p.minMatchCharLength:mt,wt=ve.includeMatches,bt=wt===void 0?p.includeMatches:wt,kt=ve.ignoreLocation,$e=kt===void 0?p.ignoreLocation:kt;if(re.length>fe)throw new Error(le(fe));for(var Be,ye=re.length,Se=me.length,ee=Math.max(0,Math.min(en,Se)),we=tn,be=ee,Re=yt>1||bt,Ke=Re?Array(Se):[];(Be=me.indexOf(re,be))>-1;){var rn=V(re,{currentLocation:Be,expectedLocation:ee,distance:Te,ignoreLocation:$e});if(we=Math.min(rn,we),be=Be+ye,Re)for(var Ge=0;Ge<ye;)Ke[Be+Ge]=1,Ge+=1}be=-1;for(var De=[],Je=1,Ne=ye+Se,on=1<<ye-1,ge=0;ge<ye;ge+=1){for(var He=0,ue=Ne;He<ue;)V(re,{errors:ge,currentLocation:ee+ue,expectedLocation:ee,distance:Te,ignoreLocation:$e})<=we?He=ue:Ne=ue,ue=Math.floor((Ne-He)/2+He);Ne=ue;var _t=Math.max(1,ee-ue+1),Xe=nn?Se:Math.min(ee+ue,Se)+ye,ke=Array(Xe+2);ke[Xe+1]=(1<<ge)-1;for(var oe=Xe;oe>=_t;oe-=1){var je=oe-1,Lt=Ye[me.charAt(je)];if(Re&&(Ke[je]=+!!Lt),ke[oe]=(ke[oe+1]<<1|1)&Lt,ge&&(ke[oe]|=(De[oe+1]|De[oe])<<1|1|De[oe+1]),ke[oe]&on&&(Je=V(re,{errors:ge,currentLocation:je,expectedLocation:ee,distance:Te,ignoreLocation:$e}))<=we){if(we=Je,(be=je)<=ee)break;_t=Math.max(1,2*ee-be)}}if(V(re,{errors:ge+1,currentLocation:ee,expectedLocation:ee,distance:Te,ignoreLocation:$e})>we)break;De=ke}var Qe={isMatch:be>=0,score:Math.max(.001,Je)};if(Re){var Et=ae(Ke,yt);Et.length?bt&&(Qe.indices=Et):Qe.isMatch=!1}return Qe}(e,H,G,{location:f+Z,distance:v,threshold:m,findAllMatches:b,minMatchCharLength:_,includeMatches:c,ignoreLocation:S}),ie=X.isMatch,pe=X.score,Oe=X.indices;ie&&(R=!0),A+=pe,ie&&Oe&&(E=[].concat(j(E),j(Oe)))});var T={isMatch:R,score:R?A/this.chunks.length:1};return R&&c&&(T.indices=E),T}}]),n}(),de=function(){function n(e){a(this,n),this.pattern=e}return u(n,[{key:"search",value:function(){}}],[{key:"isMultiMatch",value:function(e){return at(e,this.multiRegex)}},{key:"isSingleMatch",value:function(e){return at(e,this.singleRegex)}}]),n}();function at(n,e){var t=n.match(e);return t?t[1]:null}var Dt=function(n){I(t,n);var e=F(t);function t(i){return a(this,t),e.call(this,i)}return u(t,[{key:"search",value:function(i){var c=i===this.pattern;return{isMatch:c,score:c?0:1,indices:[0,this.pattern.length-1]}}}],[{key:"type",get:function(){return"exact"}},{key:"multiRegex",get:function(){return/^="(.*)"$/}},{key:"singleRegex",get:function(){return/^=(.*)$/}}]),t}(de),Nt=function(n){I(t,n);var e=F(t);function t(i){return a(this,t),e.call(this,i)}return u(t,[{key:"search",value:function(i){var c=i.indexOf(this.pattern)===-1;return{isMatch:c,score:c?0:1,indices:[0,i.length-1]}}}],[{key:"type",get:function(){return"inverse-exact"}},{key:"multiRegex",get:function(){return/^!"(.*)"$/}},{key:"singleRegex",get:function(){return/^!(.*)$/}}]),t}(de),Ht=function(n){I(t,n);var e=F(t);function t(i){return a(this,t),e.call(this,i)}return u(t,[{key:"search",value:function(i){var c=i.startsWith(this.pattern);return{isMatch:c,score:c?0:1,indices:[0,this.pattern.length-1]}}}],[{key:"type",get:function(){return"prefix-exact"}},{key:"multiRegex",get:function(){return/^\^"(.*)"$/}},{key:"singleRegex",get:function(){return/^\^(.*)$/}}]),t}(de),jt=function(n){I(t,n);var e=F(t);function t(i){return a(this,t),e.call(this,i)}return u(t,[{key:"search",value:function(i){var c=!i.startsWith(this.pattern);return{isMatch:c,score:c?0:1,indices:[0,i.length-1]}}}],[{key:"type",get:function(){return"inverse-prefix-exact"}},{key:"multiRegex",get:function(){return/^!\^"(.*)"$/}},{key:"singleRegex",get:function(){return/^!\^(.*)$/}}]),t}(de),Wt=function(n){I(t,n);var e=F(t);function t(i){return a(this,t),e.call(this,i)}return u(t,[{key:"search",value:function(i){var c=i.endsWith(this.pattern);return{isMatch:c,score:c?0:1,indices:[i.length-this.pattern.length,i.length-1]}}}],[{key:"type",get:function(){return"suffix-exact"}},{key:"multiRegex",get:function(){return/^"(.*)"\$$/}},{key:"singleRegex",get:function(){return/^(.*)\$$/}}]),t}(de),Pt=function(n){I(t,n);var e=F(t);function t(i){return a(this,t),e.call(this,i)}return u(t,[{key:"search",value:function(i){var c=!i.endsWith(this.pattern);return{isMatch:c,score:c?0:1,indices:[0,i.length-1]}}}],[{key:"type",get:function(){return"inverse-suffix-exact"}},{key:"multiRegex",get:function(){return/^!"(.*)"\$$/}},{key:"singleRegex",get:function(){return/^!(.*)\$$/}}]),t}(de),ct=function(n){I(t,n);var e=F(t);function t(i){var c,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=l.location,f=h===void 0?p.location:h,v=l.threshold,m=v===void 0?p.threshold:v,b=l.distance,_=b===void 0?p.distance:b,S=l.includeMatches,E=S===void 0?p.includeMatches:S,A=l.findAllMatches,R=A===void 0?p.findAllMatches:A,T=l.minMatchCharLength,N=T===void 0?p.minMatchCharLength:T,H=l.isCaseSensitive,G=H===void 0?p.isCaseSensitive:H,Z=l.ignoreLocation,X=Z===void 0?p.ignoreLocation:Z;return a(this,t),(c=e.call(this,i))._bitapSearch=new st(i,{location:f,threshold:m,distance:_,includeMatches:E,findAllMatches:R,minMatchCharLength:N,isCaseSensitive:G,ignoreLocation:X}),c}return u(t,[{key:"search",value:function(i){return this._bitapSearch.searchIn(i)}}],[{key:"type",get:function(){return"fuzzy"}},{key:"multiRegex",get:function(){return/^"(.*)"$/}},{key:"singleRegex",get:function(){return/^(.*)$/}}]),t}(de),lt=function(n){I(t,n);var e=F(t);function t(i){return a(this,t),e.call(this,i)}return u(t,[{key:"search",value:function(i){for(var c,l=0,h=[],f=this.pattern.length;(c=i.indexOf(this.pattern,l))>-1;)l=c+f,h.push([c,l-1]);var v=!!h.length;return{isMatch:v,score:v?0:1,indices:h}}}],[{key:"type",get:function(){return"include"}},{key:"multiRegex",get:function(){return/^'"(.*)"$/}},{key:"singleRegex",get:function(){return/^'(.*)$/}}]),t}(de),qe=[Dt,lt,Ht,jt,Pt,Wt,Nt,ct],dt=qe.length,Ft=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/;function qt(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return n.split("|").map(function(t){for(var i=t.trim().split(Ft).filter(function(A){return A&&!!A.trim()}),c=[],l=0,h=i.length;l<h;l+=1){for(var f=i[l],v=!1,m=-1;!v&&++m<dt;){var b=qe[m],_=b.isMultiMatch(f);_&&(c.push(new b(_,e)),v=!0)}if(!v)for(m=-1;++m<dt;){var S=qe[m],E=S.isSingleMatch(f);if(E){c.push(new S(E,e));break}}}return c})}var zt=new Set([ct.type,lt.type]),Vt=function(){function n(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=t.isCaseSensitive,c=i===void 0?p.isCaseSensitive:i,l=t.includeMatches,h=l===void 0?p.includeMatches:l,f=t.minMatchCharLength,v=f===void 0?p.minMatchCharLength:f,m=t.ignoreLocation,b=m===void 0?p.ignoreLocation:m,_=t.findAllMatches,S=_===void 0?p.findAllMatches:_,E=t.location,A=E===void 0?p.location:E,R=t.threshold,T=R===void 0?p.threshold:R,N=t.distance,H=N===void 0?p.distance:N;a(this,n),this.query=null,this.options={isCaseSensitive:c,includeMatches:h,minMatchCharLength:v,findAllMatches:S,ignoreLocation:b,location:A,threshold:T,distance:H},this.pattern=c?e:e.toLowerCase(),this.query=qt(this.pattern,this.options)}return u(n,[{key:"searchIn",value:function(e){var t=this.query;if(!t)return{isMatch:!1,score:1};var i=this.options,c=i.includeMatches;e=i.isCaseSensitive?e:e.toLowerCase();for(var l=0,h=[],f=0,v=0,m=t.length;v<m;v+=1){var b=t[v];h.length=0,l=0;for(var _=0,S=b.length;_<S;_+=1){var E=b[_],A=E.search(e),R=A.isMatch,T=A.indices,N=A.score;if(!R){f=0,l=0,h.length=0;break}if(l+=1,f+=N,c){var H=E.constructor.type;zt.has(H)?h=[].concat(j(h),j(T)):h.push(T)}}if(l){var G={isMatch:!0,score:f/l};return c&&(G.indices=h),G}}return{isMatch:!1,score:1}}}],[{key:"condition",value:function(e,t){return t.useExtendedSearch}}]),n}(),Ie=[];function ze(n,e){for(var t=0,i=Ie.length;t<i;t+=1){var c=Ie[t];if(c.condition(n,e))return new c(n,e)}return new st(n,e)}var Ve="$and",Ut="$or",ut="$path",Yt="$val",Ue=function(n){return!(!n[Ve]&&!n[Ut])},Kt=function(n){return!!n[ut]},Gt=function(n){return!U(n)&&K(n)&&!Ue(n)},ht=function(n){return L({},Ve,Object.keys(n).map(function(e){return L({},e,n[e])}))};function Jt(n,e){var t=e.ignoreFieldNorm,i=t===void 0?p.ignoreFieldNorm:t;n.forEach(function(c){var l=1;c.matches.forEach(function(h){var f=h.key,v=h.norm,m=h.score,b=f?f.weight:null;l*=Math.pow(m===0&&b?Number.EPSILON:m,(b||1)*(i?1:v))}),c.score=l})}function Xt(n,e){var t=n.matches;e.matches=[],y(t)&&t.forEach(function(i){if(y(i.indices)&&i.indices.length){var c={indices:i.indices,value:i.value};i.key&&(c.key=i.key.src),i.idx>-1&&(c.refIndex=i.idx),e.matches.push(c)}})}function Qt(n,e){e.score=n.score}function Zt(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=t.includeMatches,c=i===void 0?p.includeMatches:i,l=t.includeScore,h=l===void 0?p.includeScore:l,f=[];return c&&f.push(Xt),h&&f.push(Qt),n.map(function(v){var m=v.idx,b={item:e[m],refIndex:m};return f.length&&f.forEach(function(_){_(v,b)}),b})}var Me=function(){function n(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;a(this,n),this.options=s(s({},p),t),this.options.useExtendedSearch,this._keyStore=new g(this.options.keys),this.setCollection(e,i)}return u(n,[{key:"setCollection",value:function(e,t){if(this._docs=e,t&&!(t instanceof M))throw new Error("Incorrect 'index' type");this._myIndex=t||z(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}},{key:"add",value:function(e){y(e)&&(this._docs.push(e),this._myIndex.add(e))}},{key:"remove",value:function(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){return!1},t=[],i=0,c=this._docs.length;i<c;i+=1){var l=this._docs[i];e(l,i)&&(this.removeAt(i),i-=1,c-=1,t.push(l))}return t}},{key:"removeAt",value:function(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}},{key:"getIndex",value:function(){return this._myIndex}},{key:"search",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=t.limit,c=i===void 0?-1:i,l=this.options,h=l.includeMatches,f=l.includeScore,v=l.shouldSort,m=l.sortFn,b=l.ignoreFieldNorm,_=W(e)?W(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return Jt(_,{ignoreFieldNorm:b}),v&&_.sort(m),se(c)&&c>-1&&(_=_.slice(0,c)),Zt(_,this._docs,{includeMatches:h,includeScore:f})}},{key:"_searchStringList",value:function(e){var t=ze(e,this.options),i=this._myIndex.records,c=[];return i.forEach(function(l){var h=l.v,f=l.i,v=l.n;if(y(h)){var m=t.searchIn(h),b=m.isMatch,_=m.score,S=m.indices;b&&c.push({item:h,idx:f,matches:[{score:_,value:h,norm:v,indices:S}]})}}),c}},{key:"_searchLogical",value:function(e){var t=this,i=function(v,m){var b=(arguments.length>2&&arguments[2]!==void 0?arguments[2]:{}).auto,_=b===void 0||b,S=function E(A){var R=Object.keys(A),T=Kt(A);if(!T&&R.length>1&&!Ue(A))return E(ht(A));if(Gt(A)){var N=T?A[ut]:R[0],H=T?A[Yt]:A[N];if(!W(H))throw new Error(q(N));var G={keyId:O(N),pattern:H};return _&&(G.searcher=ze(H,m)),G}var Z={children:[],operator:R[0]};return R.forEach(function(X){var ie=A[X];U(ie)&&ie.forEach(function(pe){Z.children.push(E(pe))})}),Z};return Ue(v)||(v=ht(v)),S(v)}(e,this.options),c=function v(m,b,_){if(!m.children){var S=m.keyId,E=m.searcher,A=t._findMatches({key:t._keyStore.get(S),value:t._myIndex.getValueForItemAtKeyId(b,S),searcher:E});return A&&A.length?[{idx:_,item:b,matches:A}]:[]}for(var R=[],T=0,N=m.children.length;T<N;T+=1){var H=v(m.children[T],b,_);if(H.length)R.push.apply(R,j(H));else if(m.operator===Ve)return[]}return R},l=this._myIndex.records,h={},f=[];return l.forEach(function(v){var m=v.$,b=v.i;if(y(m)){var _=c(i,m,b);_.length&&(h[b]||(h[b]={idx:b,item:m,matches:[]},f.push(h[b])),_.forEach(function(S){var E,A=S.matches;(E=h[b].matches).push.apply(E,j(A))}))}}),f}},{key:"_searchObjectList",value:function(e){var t=this,i=ze(e,this.options),c=this._myIndex,l=c.keys,h=c.records,f=[];return h.forEach(function(v){var m=v.$,b=v.i;if(y(m)){var _=[];l.forEach(function(S,E){_.push.apply(_,j(t._findMatches({key:S,value:m[E],searcher:i})))}),_.length&&f.push({idx:b,item:m,matches:_})}}),f}},{key:"_findMatches",value:function(e){var t=e.key,i=e.value,c=e.searcher;if(!y(i))return[];var l=[];if(U(i))i.forEach(function(S){var E=S.v,A=S.i,R=S.n;if(y(E)){var T=c.searchIn(E),N=T.isMatch,H=T.score,G=T.indices;N&&l.push({score:H,key:t,value:E,idx:A,norm:R,indices:G})}});else{var h=i.v,f=i.n,v=c.searchIn(h),m=v.isMatch,b=v.score,_=v.indices;m&&l.push({score:b,key:t,value:h,norm:f,indices:_})}return l}}]),n}();return Me.version="6.6.2",Me.createIndex=z,Me.parseIndex=function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.getFn,i=t===void 0?p.getFn:t,c=e.fieldNormWeight,l=c===void 0?p.fieldNormWeight:c,h=n.keys,f=n.records,v=new M({getFn:i,fieldNormWeight:l});return v.setKeys(h),v.setIndexRecords(f),v},Me.config=p,function(){Ie.push.apply(Ie,arguments)}(Vt),Me},typeof it=="object"&&typeof Ee<"u"?Ee.exports=We():typeof define=="function"&&define.amd?define(We):(Ze=typeof globalThis<"u"?globalThis:Ze||self).Fuse=We();typeof window<"u"&&(window.Fuse=window.Fuse||self.Fuse||(typeof Fuse<"u"?Fuse:null));window.WheelOfHeaven=window.WheelOfHeaven||{navbar:{},search:{},ui:{}};class St{constructor(){this.activeDropdown=null,this.dropdowns=new Map,this.init()}init(){this.bindEvents(),this.initDropdowns()}initDropdowns(){document.querySelectorAll(".navbar__dropdown").forEach(o=>{const a=o.querySelector(".navbar__dropdown-trigger"),d=o.dataset.dropdown,u=document.getElementById(`${d}-dropdown`);a&&u&&d&&this.dropdowns.set(d,{element:o,trigger:a,dropdown:u,isOpen:!1})})}bindEvents(){document.addEventListener("click",s=>{const o=s.target.closest(".navbar__dropdown-trigger");if(o){s.preventDefault(),s.stopPropagation(),this.handleTriggerClick(o);return}const a=window.innerWidth<=768,d=window.isUserScrolling||!1;!s.target.closest(".navbar-dropdown")&&!s.target.closest(".navbar__dropdown")&&!s.target.closest(".navbar__content")&&!(a&&d)&&this.closeAllDropdowns()}),document.addEventListener("keydown",s=>{s.key==="Escape"&&this.closeAllDropdowns()}),this.handleMobileNavigation()}handleTriggerClick(s){if(window.innerWidth<=768)return;const a=s.closest(".navbar__dropdown")?.dataset.dropdown;if(!a||!this.dropdowns.has(a))return;this.dropdowns.get(a).isOpen?this.closeDropdown(a):(this.closeAllDropdowns(),this.openDropdown(a))}openDropdown(s){const o=this.dropdowns.get(s);!o||o.isOpen||(o.isOpen=!0,this.activeDropdown=s,o.trigger.classList.add("navbar__dropdown-trigger--active"),o.trigger.setAttribute("aria-expanded","true"),o.dropdown.classList.add("navbar-dropdown--active"),document.body.classList.add("navbar-dropdown-open"),requestAnimationFrame(()=>{this.positionDropdown(o)}))}closeDropdown(s){const o=this.dropdowns.get(s);!o||!o.isOpen||(o.isOpen=!1,this.activeDropdown===s&&(this.activeDropdown=null),o.trigger.classList.remove("navbar__dropdown-trigger--active"),o.trigger.setAttribute("aria-expanded","false"),o.dropdown.classList.remove("navbar-dropdown--active","navbar-dropdown--align-left","navbar-dropdown--align-right"),this.hasOpenDropdowns()||document.body.classList.remove("navbar-dropdown-open"))}closeAllDropdowns(){this.dropdowns.forEach((s,o)=>{s.isOpen&&this.closeDropdown(o)})}hasOpenDropdowns(){return Array.from(this.dropdowns.values()).some(s=>s.isOpen)}positionDropdown(s){const o=s.dropdown,a=s.trigger,d=document.querySelector(".navbar");o.classList.remove("navbar-dropdown--align-left","navbar-dropdown--align-right"),requestAnimationFrame(()=>{const u=d.getBoundingClientRect(),L=a.getBoundingClientRect(),I=window.innerWidth,x=u.bottom+1;o.style.top=`${x}px`;const C=L.left+L.width/2;o.style.left=`${C}px`,o.style.transform="translateX(-50%)",requestAnimationFrame(()=>{const Y=o.getBoundingClientRect();Y.right>I-20?(o.classList.add("navbar-dropdown--align-right"),o.style.left="auto",o.style.right="20px",o.style.transform="none"):Y.left<20&&(o.classList.add("navbar-dropdown--align-left"),o.style.left="20px",o.style.transform="none")})})}handleMobileNavigation(){const s=()=>{window.innerWidth<=768&&this.closeAllDropdowns()};window.addEventListener("resize",s);const o=document.getElementById("mobileNavToggle");o&&o.addEventListener("click",a=>{a.preventDefault(),a.stopPropagation(),this.closeAllDropdowns()}),window.addEventListener("scroll",()=>{window.isUserScrolling=!0,clearTimeout(window.scrollEndTimer),window.scrollEndTimer=setTimeout(()=>{window.isUserScrolling=!1},150)},{passive:!0})}}class xt{constructor(){this.configIcons=this.loadConfigIcons(),this.fallbackIcons={knowledge:`<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/>
                <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/>
            </svg>`,explainers:`<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                <path d="M12 17h.01"/>
            </svg>`,revelations:`<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                <polyline points="14,2 14,8 20,8"/>
                <line x1="16" y1="13" x2="8" y2="13"/>
                <line x1="16" y1="17" x2="8" y2="17"/>
                <polyline points="10,9 9,9 8,9"/>
            </svg>`,wiki:`<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
                <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
                <path d="M8 7h8"/>
                <path d="M8 11h8"/>
                <path d="M8 15h6"/>
            </svg>`,org:`<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
                <circle cx="9" cy="7" r="4"/>
                <path d="M22 21v-2a4 4 0 0 0-3-3.87"/>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
            </svg>`,community:`<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                <circle cx="9" cy="7" r="4"/>
                <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
            </svg>`,about:`<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <path d="M12 16v-4"/>
                <path d="M12 8h.01"/>
            </svg>`,code_of_conduct:`<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M9 12l2 2 4-4"/>
                <path d="M21 12c-1 0-3-1-3-3s2-3 3-3 3 1 3 3-2 3-3 3"/>
                <path d="M3 12c1 0 3-1 3-3s-2-3-3-3-3 1-3 3 2 3 3 3"/>
                <path d="M3 12v6a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-6"/>
            </svg>`,contributing:`<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
                <circle cx="9" cy="7" r="4"/>
                <line x1="19" y1="8" x2="19" y2="14"/>
                <line x1="22" y1="11" x2="16" y2="11"/>
            </svg>`,forums:`<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
            </svg>`,faq:`<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                <path d="M12 17h.01"/>
            </svg>`,social:`<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
            </svg>`}}loadConfigIcons(){return window.navbarIcons||{}}async getIcon(s){if(this.configIcons[s])try{const o=await fetch(this.configIcons[s]);if(o.ok)return await o.text()}catch(o){console.warn(`Failed to load icon from ${this.configIcons[s]}:`,o)}return this.fallbackIcons[s]||""}getIconSync(s){return this.fallbackIcons[s]||""}updateIcons(){this.configIcons=this.loadConfigIcons()}}document.addEventListener("DOMContentLoaded",()=>{window.WheelOfHeaven.navbar.dropdown=new St,window.WheelOfHeaven.navbar.icons=new xt,window.navbarDropdown=window.WheelOfHeaven.navbar.dropdown,window.dropdownIcons=window.WheelOfHeaven.navbar.icons});typeof Ee<"u"&&Ee.exports&&(Ee.exports={NavbarDropdown:St,DropdownIcons:xt});const Le={MOBILE_BREAKPOINT:999,SCROLL_THRESHOLD:100,SCROLL_DELTA_MIN:5,SCROLL_END_DELAY:150,ANIMATION_DELAY:150,DEBOUNCE_DELAY:100,COOKIE_DAYS:365},ce=()=>window.innerWidth<=Le.MOBILE_BREAKPOINT;document.addEventListener("DOMContentLoaded",()=>{const r=document.querySelector(".navbar"),s=document.getElementById("mobileNavToggle"),o=document.getElementById("mobileSearchToggle"),a=document.querySelector(".navbar__search-input");let d=!1,u=!1,L=window.scrollY,I=!1,x=!1,C=null;function Y(k){document.querySelectorAll(".navbar__theme-icon").forEach(M=>{M.classList.toggle("navbar__theme-icon--light",k)})}function F(){if(d){I=!1;return}const k=window.scrollY;ce()&&r?Math.abs(k-L)>Le.SCROLL_DELTA_MIN&&(k>L&&k>Le.SCROLL_THRESHOLD?(r.classList.add("navbar--hidden"),u&&q()):k<L&&r.classList.remove("navbar--hidden")):!ce&&r&&r.classList.remove("navbar--hidden"),L=k,I=!1}function j(){I||(requestAnimationFrame(F),I=!0)}function J(){x=!0,C&&clearTimeout(C)}function U(){C=setTimeout(()=>{x=!1},Le.SCROLL_END_DELAY)}window.addEventListener("scroll",()=>{J(),j(),U()},{passive:!0});function W(k,M,z=365){const V=new Date;V.setTime(V.getTime()+z*24*60*60*1e3),document.cookie=`${k}=${M};expires=${V.toUTCString()};path=/`}function se(k){const M=k+"=",z=document.cookie.split(";");for(let V=0;V<z.length;V++){let ae=z[V];for(;ae.charAt(0)===" ";)ae=ae.substring(1,ae.length);if(ae.indexOf(M)===0)return ae.substring(M.length,ae.length)}return null}setTimeout(()=>{document.querySelectorAll("#theme-toggle, #mobile-theme-toggle").forEach(M=>{M.addEventListener("click",()=>{const V=document.documentElement.getAttribute("data-theme")==="light"?"dark":"light";document.documentElement.setAttribute("data-theme",V),localStorage.setItem("theme",V),Y(V==="light")})})},10);const Q=document.documentElement.getAttribute("data-theme")||"dark";Y(Q==="light");const K=document.querySelector(".navbar__search-input");K&&document.addEventListener("keydown",k=>{k.ctrlKey&&(k.key==="/"||k.key==="?")&&(k.preventDefault(),ce()?D(!0):(K.focus(),K.select()))});const y=document.getElementById("mobileSearchInput"),$=document.querySelector(".navbar__mobile-search");function D(k=!u){const M=ce();ce&&(k&&d&&w(),u=k,r&&r.classList.toggle("navbar--search-active",k),$&&$.classList.toggle("navbar__mobile-search--active",k),k&&y&&setTimeout(()=>{y.focus()},Le.ANIMATION_DELAY))}function q(){u=!1,r&&r.classList.remove("navbar--search-active"),$&&$.classList.remove("navbar__mobile-search--active"),y&&(y.value="",y.blur()),typeof window.hideSearchModal=="function"&&window.hideSearchModal()}y&&(y.addEventListener("focus",()=>{typeof window.showSearchModal=="function"&&window.showSearchModal()}),y.addEventListener("input",k=>{const M=k.target.value;a&&(a.value=M,a.dispatchEvent(new Event("input")))}),y.addEventListener("keydown",k=>{k.key==="Escape"&&(k.preventDefault(),q())}));let le=null;function ne(k){le&&(le.contains(k.target)||k.preventDefault())}function g(){d=!0,le=r.querySelector(".navbar__content"),r&&r.classList.add("navbar--mobile-expanded"),s&&s.setAttribute("aria-expanded",!0),document.body.classList.add("mobile-nav-open"),document.addEventListener("touchmove",ne,{passive:!1})}function w(){d=!1,r&&r.classList.remove("navbar--mobile-expanded"),s&&s.setAttribute("aria-expanded",!1),document.body.classList.remove("mobile-nav-open"),document.removeEventListener("touchmove",ne),le=null,window.navbarDropdown&&window.navbarDropdown.closeAllDropdowns()}o&&o.addEventListener("click",k=>{k.preventDefault(),k.stopPropagation(),d&&w(),D()}),new MutationObserver(k=>{k.forEach(M=>{if(M.type==="attributes"&&M.attributeName==="class"){const z=document.body.classList.contains("search-modal-open");ce()&&!z&&u&&setTimeout(()=>{q()},Le.DEBOUNCE_DELAY)}})}).observe(document.body,{attributes:!0}),document.addEventListener("keydown",k=>{k.key==="Escape"&&u&&q()}),document.addEventListener("click",k=>{if(ce()&&u&&!r.contains(k.target)&&!x){const z=document.getElementById("search-modal");(!z||!z.contains(k.target))&&q()}}),s&&r&&(s.addEventListener("click",M=>{M.preventDefault(),M.stopPropagation(),u&&q(),d?w():g()}),document.addEventListener("click",M=>{if(d&&!r.contains(M.target)&&!x){const z=document.querySelector(".navbar__content");(!z||!z.contains(M.target))&&w()}}),r.querySelectorAll(".navbar__content .navbar__link, .navbar__content .navbar-dropdown__link").forEach(M=>{M.addEventListener("click",z=>{x||w()})})),window.addEventListener("resize",()=>{const k=ce();ce||(r&&(r.classList.remove("navbar--hidden","navbar--mobile-expanded","navbar--search-active"),window.navbarDropdown&&window.navbarDropdown.closeAllDropdowns(),$&&$.classList.remove("navbar__mobile-search--active")),d=!1,u=!1,s&&s.setAttribute("aria-expanded",!1),y&&(y.value=""))});const O=document.querySelector(".navbar__logo");O&&O.addEventListener("touchstart",k=>{const M=O.querySelector("img, svg");M&&(M.style.animation="logo-spin 9s linear infinite",setTimeout(()=>{M.style.animation=""},9e3))});const P=document.getElementById("lang-select"),p=document.getElementById("mobile-lang-select");function Ae(k,M){k&&M&&k.value!==M.value&&(M.value=k.value)}P&&p&&(P.addEventListener("change",()=>{Ae(P,p)}),p.addEventListener("change",()=>{Ae(p,P),d&&w()})),o&&o.addEventListener("click",k=>{setTimeout(()=>{const M=document.getElementById("search-modal");M&&!M.classList.contains("search-modal--active")&&typeof window.showSearchModal=="function"&&window.showSearchModal()},50)})});let _e=null,tt=null,he="en",te=new Set;const rt="woh-recent-searches",an=5,Ct={Wiki:{icon:`<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
            <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
            <path d="M8 7h8"/><path d="M8 11h8"/><path d="M8 15h6"/>
        </svg>`,label:"Wiki"},Essentials:{icon:`<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <path d="M8 12h8"/><path d="M12 8v8"/>
        </svg>`,label:"Essentials"},Explainers:{icon:`<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
            <path d="M12 17h.01"/>
        </svg>`,label:"Explainers"},Timeline:{icon:`<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <polyline points="12,6 12,12 16,14"/>
        </svg>`,label:"Timeline"},Resources:{icon:`<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/>
            <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/>
        </svg>`,label:"Resources"},Articles:{icon:`<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
            <polyline points="14,2 14,8 20,8"/>
        </svg>`,label:"Articles"},Library:{icon:`<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"/>
        </svg>`,label:"Library"}},cn=[{term:"Elohim",section:"Wiki"},{term:"Raelism",section:"Wiki"},{term:"Genesis",section:"Wiki"},{term:"Age of Aquarius",section:"Timeline"},{term:"extraterrestrial",section:"Wiki"},{term:"creation",section:"Wiki"},{term:"ancient astronauts",section:"Explainers"},{term:"intelligent design",section:"Wiki"}];async function ln(){try{he=document.documentElement.lang||"en";let r;try{if(r=await fetch(`/search_index.${he}.json`),_e=await r.json(),!_e||_e.length<5)throw new Error("Search index too small, falling back to English")}catch(o){console.warn(`Failed to load search index for ${he}, falling back to English:`,o),r=await fetch("/search_index.en.json"),_e=await r.json(),he="en"}const s={keys:[{name:"title",weight:.5},{name:"body",weight:.5}],threshold:.3,distance:100,includeMatches:!0,includeScore:!0,minMatchCharLength:2,findAllMatches:!0,ignoreLocation:!0,useExtendedSearch:!0,shouldSort:!0,tokenize:!1,matchAllTokens:!1};tt=new Fuse(_e,s),console.log("Search initialized successfully with",_e.length,"items")}catch(r){console.error("Error initializing search:",r)}}function At(r){return Ct[r]?.icon||""}function It(r){const a=ot(r).replace(/^\/(?:de|fr|es|ru|ja|zh|zh-Hant|ko)\//,"/").split("/").filter(Boolean);if(a.length===0)return"Home";const d=a[0];return{wiki:"Wiki",essentials:"Essentials",revelations:"Library",library:"Library",explainers:"Explainers",timeline:"Timeline",articles:"Articles",resources:"Resources"}[d]||d.charAt(0).toUpperCase()+d.slice(1)}function ot(r){try{return new URL(r).pathname}catch{return r.replace(/^https?:\/\/[^\/]+/,"")}}function dn(){const r=he==="en"?"":`/${he}`;return[{title:"Home",url:r||"/",section:"Home",description:"Welcome page and site overview"},{title:"Essentials",url:`${r}/essentials/`,section:"Essentials",description:"Core concepts and fundamental information"},{title:"Explainers",url:`${r}/explainers/`,section:"Explainers",description:"Detailed explanations of key topics"},{title:"Timeline",url:`${r}/timeline/`,section:"Timeline",description:"Chronological overview of events"},{title:"Wiki",url:`${r}/wiki/`,section:"Wiki",description:"Comprehensive knowledge database"},{title:"Resources",url:`${r}/resources/`,section:"Resources",description:"Books, films, and external references"}]}function Ot(){try{const r=localStorage.getItem(rt);return r?JSON.parse(r):[]}catch{return[]}}function un(r){if(!r||r.trim().length<2)return;const s=Ot(),o=r.trim().toLowerCase(),a=s.filter(u=>u.toLowerCase()!==o);a.unshift(r.trim());const d=a.slice(0,an);try{localStorage.setItem(rt,JSON.stringify(d))}catch(u){console.warn("Could not save recent search:",u)}}function hn(){try{localStorage.removeItem(rt)}catch(r){console.warn("Could not clear recent searches:",r)}}function xe(){const r=Object.entries(Ct).map(([s,o])=>{const a=te.has(s);return`
            <button class="search-filter-chip ${a?"search-filter-chip--active":""}"
                    data-section="${s}"
                    aria-pressed="${a}">
                <span class="search-filter-chip__icon">${o.icon}</span>
                <span class="search-filter-chip__label">${o.label}</span>
            </button>
        `}).join("");return`
        <div class="search-filters">
            <div class="search-filters__header">
                <span class="search-filters__label">Filter by section</span>
                ${te.size>0?'<button class="search-filters__clear">Clear all</button>':""}
            </div>
            <div class="search-filters__chips">${r}</div>
        </div>
    `}function fn(){const r=Ot();let s="";return r.length>0&&(s+=`
            <div class="search-suggestions">
                <div class="search-suggestions__header">
                    <span class="search-suggestions__label">Recent searches</span>
                    <button class="search-suggestions__clear" id="clear-recent">Clear</button>
                </div>
                <div class="search-suggestions__list">
                    ${r.map(o=>`
                        <button class="search-suggestion" data-term="${o}">
                            <svg class="search-suggestion__icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <polyline points="12,6 12,12 16,14"/>
                            </svg>
                            <span class="search-suggestion__text">${o}</span>
                        </button>
                    `).join("")}
                </div>
            </div>
        `),s+=`
        <div class="search-suggestions">
            <div class="search-suggestions__header">
                <span class="search-suggestions__label">Popular searches</span>
            </div>
            <div class="search-suggestions__list">
                ${cn.slice(0,6).map(o=>`
                    <button class="search-suggestion" data-term="${o.term}">
                        <svg class="search-suggestion__icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"/>
                            <path d="m21 21-4.3-4.3"/>
                        </svg>
                        <span class="search-suggestion__text">${o.term}</span>
                        <span class="search-suggestion__section">${o.section}</span>
                    </button>
                `).join("")}
            </div>
        </div>
    `,s}function Tt(){return`
        <div class="search-modal__navigation">
            <h4 class="search-modal__navigation-title">Browse sections</h4>
            ${dn().map(s=>`
                <a href="${s.url}" class="search-result search-result--nav">
                    <div class="search-result__left">
                        <div class="search-result__title">${s.title}</div>
                        <div class="search-result__url">${s.url}</div>
                    </div>
                    <div class="search-result__right">
                        <div class="search-result__section">
                            <span class="search-result__section-icon">${At(s.section)}</span>
                            ${s.section}
                        </div>
                    </div>
                </a>
            `).join("")}
        </div>
    `}function $t(){return`
        ${xe()}
        ${fn()}
        ${Tt()}
    `}function vn(){const r=document.createElement("div");return r.id="search-modal",r.className="search-modal",r.innerHTML=`
        <div class="search-modal__backdrop"></div>
        <div class="search-modal__container">
            <div class="search-modal__header">
                <h3 class="search-modal__title">Search</h3>
                <div class="search-modal__shortcut">Press <kbd>Esc</kbd> to close</div>
                <button class="search-modal__close" aria-label="Close search">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="search-modal__results" id="search-results">
                ${$t()}
            </div>
        </div>
    `,document.body.appendChild(r),nt(r),Bt(r),r}function nt(r){r.addEventListener("click",s=>{const o=s.target.closest(".search-filter-chip");if(o){const d=o.dataset.section;te.has(d)?te.delete(d):te.add(d);const u=r.querySelector(".search-filters");u&&(u.outerHTML=xe());const L=document.querySelector(".navbar__search-input");L&&L.value.trim()&&Fe(L.value)}if(s.target.closest(".search-filters__clear")){te.clear();const d=r.querySelector(".search-filters");d&&(d.outerHTML=xe());const u=document.querySelector(".navbar__search-input");u&&u.value.trim()&&Fe(u.value)}})}function Bt(r){r.addEventListener("click",s=>{const o=s.target.closest(".search-suggestion");if(o){const d=o.dataset.term,u=document.querySelector(".navbar__search-input");u&&d&&(u.value=d,Fe(d))}s.target.closest("#clear-recent")&&(hn(),Ce([],""))})}function Mt(r,s){if(!s||s.trim().length<2)return r;const o=s.toLowerCase().split(/\s+/).filter(d=>d.length>=2);if(o.length===0)return r;let a=r;return o.forEach(d=>{const u=d.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),L=new RegExp(`(${u})`,"gi");a=a.replace(L,'<mark class="search-highlight">$1</mark>')}),a}function gn(r,s,o=150){if(!r)return"";if(r.length<=o)return r;let a=Math.floor(r.length/2);s&&s.length>0&&s[0].indices&&s[0].indices.length>0&&(a=s[0].indices[0][0]);const d=Math.max(0,a-Math.floor(o/2)),u=Math.min(r.length,d+o);let L=r.slice(d,u);return d>0&&(L="..."+L),u<r.length&&(L=L+"..."),L}function pn(r){return r.filter(s=>{const o=s.item.url,a=ot(o),d=It(o);let u=!1;he==="en"?u=!a.match(/^\/(?:de|fr|es|ru|ja|zh|zh-Hant|ko)\//):u=a.startsWith(`/${he}/`);let L=!0;return te.size>0&&(L=te.has(d)),u&&L})}function mn(r){return`
        ${xe()}
        <div class="search-modal__empty-state">
            <div class="search-modal__empty-icon">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                    <line x1="8" y1="11" x2="14" y2="11"></line>
                </svg>
            </div>
            <h4 class="search-modal__empty-title">No results found</h4>
            <p class="search-modal__empty-text">
                No matches for "<strong>${r}</strong>"${te.size>0?" in selected sections":""}.
                Try different keywords${te.size>0?" or clear filters":""}.
            </p>
        </div>
        ${Tt()}
    `}function yn(r,s){return`
        <div class="search-results-count">
            <span class="search-results-count__number">${r}</span>
            <span class="search-results-count__text">result${r!==1?"s":""} for "${s}"</span>
        </div>
    `}function Ce(r,s=""){const o=document.getElementById("search-results");if(!o)return;if(!r||r.length===0){s&&s.trim().length>=2?o.innerHTML=mn(s):o.innerHTML=$t(),nt(document.getElementById("search-modal")),Bt(document.getElementById("search-modal"));return}const a=r.slice(0,15).map(d=>{const{item:u,matches:L}=d,I=Mt(u.title,s),x=gn(u.body,L?.filter(j=>j.key==="body")||[],140),C=Mt(x,s),Y=ot(u.url),F=It(u.url);return`
            <a href="${u.url}" class="search-result">
                <div class="search-result__left">
                    <div class="search-result__title">${I}</div>
                    <div class="search-result__url">${Y}</div>
                    <div class="search-result__section">
                        <span class="search-result__section-icon">${At(F)}</span>
                        ${F}
                    </div>
                </div>
                <div class="search-result__right">
                    <div class="search-result__body">${C}</div>
                </div>
            </a>
        `}).join("");o.innerHTML=`
        ${xe()}
        ${yn(r.length,s)}
        ${a}
    `,nt(document.getElementById("search-modal"))}function wn(r,s){let o;return function(...d){const u=()=>{clearTimeout(o),r(...d)};clearTimeout(o),o=setTimeout(u,s)}}function Fe(r){if(!tt||!r.trim()||r.trim().length<2){Ce([]);return}const s=tt.search(r),o=pn(s);Ce(o,r),r.trim().length>=3&&un(r)}const bn=wn(Fe,150);function et(){const r=document.getElementById("search-modal"),s=document.body;r&&(window.navbarDropdown&&window.navbarDropdown.closeAllDropdowns(),r.classList.add("search-modal--active"),s.classList.add("search-modal-open"),document.querySelectorAll("main, footer, .totop").forEach(a=>{a.style.filter="blur(4px)",a.style.transition="filter 0.3s ease"}))}function Pe(){const r=document.getElementById("search-modal"),s=document.body;if(r){r.classList.remove("search-modal--active"),s.classList.remove("search-modal-open"),document.querySelectorAll("main, footer, .totop").forEach(d=>{d.style.filter="none"});const a=document.querySelector(".navbar__search-input");a&&(a.value=""),te.clear(),Ce([])}}document.addEventListener("DOMContentLoaded",async()=>{await ln();const r=vn(),s=document.querySelector(".navbar__search-input");s&&(s.addEventListener("focus",et),s.addEventListener("click",et),s.addEventListener("input",d=>{const u=d.target.value;u.trim()&&!r.classList.contains("search-modal--active")&&et(),bn(u),!u.trim()&&r.classList.contains("search-modal--active")&&Ce([])}),s.addEventListener("keydown",d=>{d.key==="Enter"&&d.preventDefault()}));const o=r.querySelector(".search-modal__close"),a=r.querySelector(".search-modal__backdrop");o.addEventListener("click",Pe),a.addEventListener("click",Pe),r.addEventListener("click",d=>{const u=d.target.closest(".search-result");u&&u.href&&Pe()}),document.addEventListener("keydown",d=>{(d.ctrlKey||d.metaKey)&&d.key==="/"&&(d.preventDefault(),s&&s.focus()),d.key==="Escape"&&(Pe(),s&&s.blur())})});document.addEventListener("keydown",r=>{const s=document.getElementById("search-modal");if(!s||!s.classList.contains("search-modal--active"))return;const o=s.querySelectorAll(".search-result"),d=[...s.querySelectorAll(".search-suggestion"),...o],u=document.activeElement,L=document.querySelector(".navbar__search-input");if(r.key==="ArrowDown")if(r.preventDefault(),u===L)d[0]?.focus();else{const I=Array.from(d).indexOf(u),x=Math.min(I+1,d.length-1);d[x]?.focus()}else if(r.key==="ArrowUp"){r.preventDefault();const I=Array.from(d).indexOf(u);I>0?d[I-1]?.focus():L?.focus()}});(function(){"use strict";const r="woh-reading-list";let o=[],a=null;function d(){u(),F(),U(),$(),j()}function u(){try{const g=localStorage.getItem(r);g&&(o=JSON.parse(g),o=o.filter(w=>w.url&&w.title))}catch(g){console.error("[ReadingList] Error loading:",g),o=[]}}function L(){try{localStorage.setItem(r,JSON.stringify(o))}catch(g){console.error("[ReadingList] Error saving:",g)}}function I(g){return o.findIndex(B=>B.url===g.url)!==-1?!1:(o.unshift({url:g.url,title:g.title,description:g.description||"",section:g.section||"",addedAt:Date.now()}),o.length>100&&(o=o.slice(0,100)),L(),Y(g.url),W(),j(),!0)}function x(g){const w=o.findIndex(B=>B.url===g);return w!==-1?(o.splice(w,1),L(),W(),j(),!0):!1}function C(g){return o.some(w=>w.url===g)}function Y(g){"serviceWorker"in navigator&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({type:"CACHE_URLS",urls:[g]})}function F(){document.addEventListener("click",g=>{const w=g.target.closest("[data-bookmark]");if(!w)return;g.preventDefault();const B=w.dataset.url||window.location.pathname,O=w.dataset.title||document.title,P=w.dataset.description||"",p=w.dataset.section||"";C(B)?(x(B),ne(D("removedFromList","Removed from reading list"))):(I({url:B,title:O,description:P,section:p}),ne(D("addedToList","Added to reading list")))})}function j(){document.querySelectorAll("[data-bookmark]").forEach(w=>{const B=w.dataset.url||window.location.pathname,O=C(B);w.classList.toggle("is-bookmarked",O),w.setAttribute("aria-pressed",O);const P=w.querySelector(".bookmark-icon-filled"),p=w.querySelector(".bookmark-icon-outline");P&&p&&(P.style.display=O?"block":"none",p.style.display=O?"none":"block")}),J()}function J(){const g=document.querySelector(".reading-list-toggle__badge");if(g){const w=o.length;g.textContent=w,g.style.display=w>0?"flex":"none"}}function U(){a=document.createElement("div"),a.className="reading-list-panel",a.id="readingListPanel",a.setAttribute("role","dialog"),a.setAttribute("aria-labelledby","readingListTitle"),a.setAttribute("aria-hidden","true"),a.innerHTML=`
            <div class="reading-list-panel__backdrop"></div>
            <div class="reading-list-panel__content">
                <header class="reading-list-panel__header">
                    <h2 class="reading-list-panel__title" id="readingListTitle">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                            <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"/>
                        </svg>
                        ${D("readingList","Reading List")}
                    </h2>
                    <button class="reading-list-panel__close" aria-label="${D("close","Close")}" data-close-reading-list>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </header>
                <div class="reading-list-panel__body">
                    <div class="reading-list-panel__empty">
                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                            <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"/>
                        </svg>
                        <p>${D("emptyReadingList","Your reading list is empty")}</p>
                        <p class="reading-list-panel__empty-hint">${D("emptyReadingListHint","Bookmark articles to save them for later")}</p>
                    </div>
                    <ul class="reading-list-panel__list"></ul>
                </div>
                <footer class="reading-list-panel__footer">
                    <button class="reading-list-panel__clear" data-clear-reading-list>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                            <polyline points="3 6 5 6 21 6"></polyline>
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                        </svg>
                        ${D("clearAll","Clear all")}
                    </button>
                </footer>
            </div>
        `,document.body.appendChild(a);const g=a.querySelector(".reading-list-panel__backdrop"),w=a.querySelector("[data-close-reading-list]"),B=a.querySelector("[data-clear-reading-list]");g?.addEventListener("click",Q),w?.addEventListener("click",Q),B?.addEventListener("click",y),document.addEventListener("click",O=>{O.target.closest("[data-toggle-reading-list]")&&(O.preventDefault(),K())}),W()}function W(){if(!a)return;const g=a.querySelector(".reading-list-panel__list"),w=a.querySelector(".reading-list-panel__empty"),B=a.querySelector(".reading-list-panel__footer");if(o.length===0){w.style.display="flex",g.style.display="none",B.style.display="none";return}w.style.display="none",g.style.display="block",B.style.display="flex",g.innerHTML=o.map(O=>`
            <li class="reading-list-panel__item">
                <a href="${q(O.url)}" class="reading-list-panel__link">
                    ${O.section?`<span class="reading-list-panel__section">${q(O.section)}</span>`:""}
                    <span class="reading-list-panel__item-title">${q(O.title)}</span>
                    ${O.description?`<span class="reading-list-panel__item-desc">${q(le(O.description,100))}</span>`:""}
                </a>
                <button class="reading-list-panel__remove" data-remove-url="${q(O.url)}" aria-label="${D("remove","Remove")}">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </li>
        `).join(""),g.querySelectorAll("[data-remove-url]").forEach(O=>{O.addEventListener("click",P=>{P.preventDefault(),P.stopPropagation();const p=O.dataset.removeUrl;x(p),ne(D("removedFromList","Removed from reading list"))})}),J()}function se(){if(!a)return;a.classList.add("reading-list-panel--open"),a.setAttribute("aria-hidden","false"),document.body.style.overflow="hidden",a.querySelector("button, a")?.focus()}function Q(){a&&(a.classList.remove("reading-list-panel--open"),a.setAttribute("aria-hidden","true"),document.body.style.overflow="")}function K(){a?.classList.contains("reading-list-panel--open")?Q():se()}function y(){o.length!==0&&confirm(D("confirmClear","Clear all items from your reading list?"))&&(o=[],L(),W(),j(),ne(D("listCleared","Reading list cleared")))}function $(){document.addEventListener("keydown",g=>{const w=document.activeElement,B=w?.tagName?.toLowerCase();if(B==="input"||B==="textarea"||w?.isContentEditable||g.ctrlKey||g.metaKey||g.altKey)return;const O=document.querySelector(".search-modal--open, .keyboard-shortcuts-modal--open, .ask-ai__panel--open");if(g.key==="b"&&!g.shiftKey&&!O){const P=document.querySelector("[data-bookmark]");P&&(g.preventDefault(),P.click())}else g.key==="B"&&g.shiftKey&&!O?(g.preventDefault(),se()):g.key==="Escape"&&a?.classList.contains("reading-list-panel--open")&&(g.preventDefault(),Q())})}function D(g,w){return window.readingListTranslations?.[g]||w}function q(g){const w=document.createElement("div");return w.textContent=g,w.innerHTML}function le(g,w){return g.length<=w?g:g.substring(0,w).trim()+"\u2026"}function ne(g){const w=document.querySelector(".snackbar");if(w)w.textContent=g,w.classList.add("snackbar--visible"),setTimeout(()=>{w.classList.remove("snackbar--visible")},3e3);else{const B=document.createElement("div");B.className="snackbar snackbar--visible",B.textContent=g,document.body.appendChild(B),setTimeout(()=>{B.remove()},3e3)}}window.ReadingList={add:I,remove:x,isInList:C,getAll:()=>[...o],open:se,close:Q,toggle:K},document.readyState==="loading"?document.addEventListener("DOMContentLoaded",d):d()})();(function(){"use strict";let r=null,s=navigator.onLine,o=null,a=null;function d(){u(),I(),j(),U()}function u(){"serviceWorker"in navigator&&(window.addEventListener("load",async()=>{try{const y=await navigator.serviceWorker.register("/sw.js",{scope:"/"});console.log("[PWA] Service Worker registered:",y.scope),y.addEventListener("updatefound",()=>{const $=y.installing;$.addEventListener("statechange",()=>{$.state==="installed"&&navigator.serviceWorker.controller&&Q()})})}catch(y){console.error("[PWA] Service Worker registration failed:",y)}}),navigator.serviceWorker.addEventListener("message",L))}function L(y){y.data.type==="CACHE_COMPLETE"&&K("Page saved for offline reading")}function I(){window.addEventListener("beforeinstallprompt",y=>{y.preventDefault(),r=y,localStorage.getItem("pwa-install-dismissed")||x()}),window.addEventListener("appinstalled",()=>{console.log("[PWA] App installed"),r=null,C(),localStorage.setItem("pwa-installed","true")})}function x(){o||(o=document.createElement("div"),o.className="pwa-install-banner",o.innerHTML=`
            <div class="pwa-install-banner__content">
                <div class="pwa-install-banner__icon">
                    <img src="/brand/icon-192.png" alt="" width="40" height="40">
                </div>
                <div class="pwa-install-banner__text">
                    <strong>Install Wheel of Heaven</strong>
                    <span>Add to home screen for offline access</span>
                </div>
            </div>
            <div class="pwa-install-banner__actions">
                <button class="pwa-install-banner__btn pwa-install-banner__btn--dismiss" aria-label="Dismiss">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
                <button class="pwa-install-banner__btn pwa-install-banner__btn--install">Install</button>
            </div>
        `,document.body.appendChild(o),requestAnimationFrame(()=>{o.classList.add("pwa-install-banner--visible")}),o.querySelector(".pwa-install-banner__btn--install").addEventListener("click",F),o.querySelector(".pwa-install-banner__btn--dismiss").addEventListener("click",Y))}function C(){o&&(o.classList.remove("pwa-install-banner--visible"),setTimeout(()=>{o&&o.parentNode&&o.parentNode.removeChild(o),o=null},300))}function Y(){localStorage.setItem("pwa-install-dismissed","true"),C()}async function F(){if(!r)return;r.prompt();const{outcome:y}=await r.userChoice;console.log("[PWA] Install prompt outcome:",y),r=null,C()}function j(){a=document.createElement("div"),a.className="offline-indicator",a.setAttribute("role","status"),a.setAttribute("aria-live","polite"),a.innerHTML=`
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                <line x1="1" y1="1" x2="23" y2="23"></line>
                <path d="M16.72 11.06A10.94 10.94 0 0 1 19 12.55"></path>
                <path d="M5 12.55a10.94 10.94 0 0 1 5.17-2.39"></path>
                <path d="M10.71 5.05A16 16 0 0 1 22.58 9"></path>
                <path d="M1.42 9a15.91 15.91 0 0 1 4.7-2.88"></path>
                <path d="M8.53 16.11a6 6 0 0 1 6.95 0"></path>
                <line x1="12" y1="20" x2="12.01" y2="20"></line>
            </svg>
            <span>You're offline</span>
        `,document.body.appendChild(a),J(),window.addEventListener("online",()=>{s=!0,J(),K("You're back online")}),window.addEventListener("offline",()=>{s=!1,J()})}function J(){a&&(s?a.classList.remove("offline-indicator--visible"):a.classList.add("offline-indicator--visible"),document.body.classList.toggle("is-offline",!s))}function U(){document.querySelectorAll("[data-save-offline]").forEach($=>{$.addEventListener("click",()=>W($))}),se()}function W(y){if(!("serviceWorker"in navigator)||!navigator.serviceWorker.controller){K("Offline saving not available");return}const $=window.location.pathname;navigator.serviceWorker.controller.postMessage({type:"CACHE_URLS",urls:[$]}),y&&(y.classList.add("is-saved"),y.innerHTML=`
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
                Saved Offline
            `)}async function se(){if("caches"in window)try{await(await caches.open("woh-pages-v1")).match(window.location.pathname)&&document.querySelectorAll("[data-save-offline]").forEach(q=>{q.classList.add("is-saved"),q.innerHTML=`
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="20 6 9 17 4 12"></polyline>
                        </svg>
                        Saved Offline
                    `})}catch(y){console.error("[PWA] Error checking cache:",y)}}function Q(){const y=document.createElement("div");y.className="pwa-update-banner",y.innerHTML=`
            <span>A new version is available</span>
            <button class="pwa-update-banner__btn" onclick="location.reload()">Refresh</button>
        `,document.body.appendChild(y),requestAnimationFrame(()=>{y.classList.add("pwa-update-banner--visible")})}function K(y){const $=document.querySelector(".snackbar");if($)$.textContent=y,$.classList.add("snackbar--visible"),setTimeout(()=>{$.classList.remove("snackbar--visible")},3e3);else{const D=document.createElement("div");D.className="snackbar snackbar--visible",D.textContent=y,document.body.appendChild(D),setTimeout(()=>{D.remove()},3e3)}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",d):d()})();(function(){"use strict";const r={ROOT_MARGIN:"-80px 0px -60% 0px",THRESHOLD:0,ACTIVE_CLASS:"wiki__toc-link--active",TOC_SELECTOR:".wiki__toc-nav",HEADING_SELECTOR:"h1[id], h2[id], h3[id], h4[id]",CONTENT_SELECTOR:".wiki__content"};class s{constructor(){this.tocNav=document.querySelector(r.TOC_SELECTOR),this.contentArea=document.querySelector(r.CONTENT_SELECTOR),!(!this.tocNav||!this.contentArea)&&(this.tocLinks=this.tocNav.querySelectorAll("a[href^='#']"),this.headings=this.contentArea.querySelectorAll(r.HEADING_SELECTOR),!(this.tocLinks.length===0||this.headings.length===0)&&this.init())}init(){this.createObserver(),this.observeHeadings(),this.bindTocClicks()}createObserver(){this.observer=new IntersectionObserver(a=>{a.forEach(d=>{d.isIntersecting&&this.setActiveLink(d.target.id)})},{rootMargin:r.ROOT_MARGIN,threshold:r.THRESHOLD})}observeHeadings(){this.headings.forEach(a=>{a.id&&this.observer.observe(a)})}setActiveLink(a){this.tocLinks.forEach(u=>{u.classList.remove(r.ACTIVE_CLASS)});const d=this.tocNav.querySelector(`a[href="#${a}"]`);d&&(d.classList.add(r.ACTIVE_CLASS),this.scrollTocToView(d))}scrollTocToView(a){const d=this.tocNav,u=a.getBoundingClientRect(),L=d.getBoundingClientRect();(u.top<L.top||u.bottom>L.bottom)&&a.scrollIntoView({behavior:"smooth",block:"center"})}bindTocClicks(){this.tocLinks.forEach(a=>{a.addEventListener("click",d=>{d.preventDefault();const u=a.getAttribute("href").slice(1),L=document.getElementById(u);if(L){const C=L.getBoundingClientRect().top+window.pageYOffset-80;window.scrollTo({top:C,behavior:"smooth"}),this.setActiveLink(u),history.pushState(null,null,`#${u}`)}})})}destroy(){this.observer&&this.observer.disconnect()}}document.addEventListener("DOMContentLoaded",()=>{document.querySelector(".wiki")&&(window.tocScrollSpy=new s)})})();document.addEventListener("DOMContentLoaded",()=>{const r=document.getElementById("toTopBtn");window.addEventListener("scroll",()=>{window.scrollY>300?r.classList.add("to-top--visible"):r.classList.remove("to-top--visible")}),r.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})})});(function(){"use strict";const r=new Set;let s=null;function o(){return!(navigator.connection&&(navigator.connection.saveData||navigator.connection.effectiveType==="2g"))}function a(x){const C=x.href;return!(r.has(C)||x.origin!==window.location.origin||x.pathname===window.location.pathname&&x.hash||!C.startsWith("http")||x.hasAttribute("download")||x.target==="_blank")}function d(x){if(r.has(x))return;const C=document.createElement("link");C.rel="prefetch",C.href=x,C.as="document",document.head.appendChild(C),r.add(x)}function u(x){if(!o())return;const C=x.target.closest("a[href]");!C||!a(C)||(s=setTimeout(()=>{d(C.href)},100))}function L(x){s&&(clearTimeout(s),s=null)}function I(){document.body.addEventListener("mouseenter",u,!0),document.body.addEventListener("mouseleave",L,!0),document.body.addEventListener("touchstart",function(x){if(!o())return;const C=x.target.closest("a[href]");C&&a(C)&&d(C.href)},{passive:!0})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",I):I()})()});kn();})();
